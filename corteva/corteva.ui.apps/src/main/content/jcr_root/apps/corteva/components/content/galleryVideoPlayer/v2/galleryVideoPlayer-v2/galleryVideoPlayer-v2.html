<!--/*
  Copyright 2018,SapientRazorfish_; All Rights Reserved.

  This software is the confidential and proprietary information of SapientRazorfish_,
  ("Confidential Information"). You shall not disclose such Confidential Information and shall use it only in
  accordance with the terms of the license agreement you entered into with SapientRazorfish_.
*/-->
<sly data-sly-use.clientlib="/libs/granite/sightly/templates/clientlib.html" /> 
<sly data-sly-call="${clientlib.all @ categories='components.galleryVideoPlayerv2'}"/>

<div data-sly-use.comElement="com.corteva.model.component.models.CommonElementsModel" class="feature-flag" data-componentname="${comElement.componentName}" data-featureflagvalue="${comElement.featureFlagState}">
   <sly data-sly-test="${comElement.featureFlagState == 'on'}">
      <sly data-sly-use.galleryVideo="com.corteva.model.component.models.GalleryVideoPlayerModel">
         <sly data-sly-test="${wcmmode.edit && !wcmmode.preview}" class="aem-helper">
            Edit Gallery Video Player V2
            <sly data-sly-test.youtubeApi="${galleryVideo.youtubeApi}" />
            <sly data-sly-test.youtubeKey="${galleryVideo.youtubeKey}" />
         </sly>
         <div class="youtube-info" data-youtube-api="${youtubeApi}" data-youtube-key="${youtubeKey}"></div>
         <sly data-sly-test="${properties.videoType == 'youtube'}">
            <div class="band white str02-gallery-video-player youtube-video-wrapper-gallery">
               <sly data-sly-list="${galleryVideo.youtubeVideoDetails}">
                  <sly data-sly-test.isFirstVideo="${itemList.first}" />
                  <sly data-sly-test="${isFirstVideo}">
                     <div class="band-content">
                        <div class="atm01-header-v1__wrapper ">
                           <sly data-sly-test="${item.videoTitle}">
                              <h2>
                                 ${item.videoTitle @ context = 'html'}
                              </h2>
                           </sly>
                        </div>
                        <div id="${item.videoId}-video-container" class="youtube-video-container" data-videoID="${item.videoId}" data-analytics-type="video" data-analytics-value="play" data-analytics-video-name=${item.videoTitle} data-analytics-video-id=${item.videoId}>
                           <div id="${item.videoId}-video-player"></div>
                        </div>
                        <sly data-sly-test="${item.videoDescription}">
                           <p class="description no-content">${item.videoDescription @ context = 'html'}</p>
                        </sly>
                     </div>
                  </sly>
               </sly>
               <sly data-sly-test="${galleryVideo.youtubeVideoDetails.size > 1}">
                  <nav class="more-videos">
                     <div class="band-content ${properties.rowType} youtube-video-wrapper">
                        <sly data-sly-list="${galleryVideo.youtubeVideoDetails}">
                           <sly data-sly-test.isFirstVideo="${itemList.first}" />
                           <a href="javascript:void(0)" class="${isFirstVideo?'active':''} galleryvideoitem" id="${item.videoId}" data-id="${itemList.index}" onclick="send_to_top(this)" data-videoid="${item.videoId}" data-analytics-type="video" data-analytics-value="play" data-analytics-video-name=${item.videoTitle} data-analytics-video-id=${item.videoId}>
                              <span class="video-listing">
                                 <img src="${item.videoThumbnail}" alt="${item.videoAltText}">
                              </span>
                              <span class="title">${item.videoTitle}</span>
                              <span class="desc">
                                 ${item.videoDescription @ context = 'html'}
                              </span>
                           </a>
                        </sly>
                     </div>
                  </nav>
               </sly>
            </div>
         </sly>
         <sly data-sly-test="${properties.videoType == 'scene7'}">
            <div class="band white str02-gallery-video-player scene7-video-wrapper">
               <sly data-sly-list="${galleryVideo.sceneSevenVideoDetails}">
                  <sly data-sly-test.isFirstVideo="${itemList.first}" />
                  <sly data-sly-test="${isFirstVideo}">
                     <div class="band-content"  ${properties.rowType}>
                        <div class="atm01-header-v1__wrapper ">
                           <sly data-sly-test="${item.videoTitle}">
                              <h2>
                                 ${item.videoTitle @ context = 'html'}
                              </h2>
                           </sly>
                        </div>
                           <div id="video-container" class="scene7-video-container ready">
                              <video poster="${item.videoThumbnail}">
                                 <source src="${item.videoId}">
                              </video>
                           </div>
                           <sly data-sly-test="${item.videoDescription}">
                              <p class="description">${item.videoDescription @ context = 'html'}</p>
                           </sly>
                        </div>
                  </sly>
               </sly>
               <sly data-sly-test="${galleryVideo.sceneSevenVideoDetails.size > 1}">
                  <nav class="more-videos">
                     <div class="band-content ${properties.rowType}">
                        <sly data-sly-list="${galleryVideo.sceneSevenVideoDetails}">
                           <sly data-sly-test.isFirstVideo="${itemList.first}" />
                           <a href="javascript:void(0)"  class="${isFirstVideo?'active':''}  galleryvideoitem" onclick="send_to_topScene7(this)" id="${item.videoId}" data-id="${itemList.index}"  data-videourl="${item.videoId}">
                              <span class="video-listing">
                                 <img src="${item.videoThumbnail}" alt="${item.videoAltText}"> 
                              </span>
                              <span class="title">${item.videoTitle}</span>
                              <span class="desc">
                                 ${item.videoDescription @ context = 'html'}
                              </span>
                           </a>
                        </sly>
                     </div>
                  </nav>
               </sly>
            </div>
         </sly>
      </sly>
   </sly>
</div>

<script>
var firstFlag = true;
function send_to_top(element,flag){
	var hashVal = $(element).data("id")-1;
    	document.location.hash = hashVal+1;
        $(window).scrollTop($('.youtube-video-wrapper-gallery').offset().top-80);
} 



$(window).on("load",function(){
 if(document.location.hash){
        var hashId = document.location.hash;    
        $(".galleryvideoitem").each(function(){
			var firstFlag = false;
            var hashString = "#"+($(this).data("id"))
            if(hashString == hashId){
                $(this).click();
            }

        });

    }
});
function send_to_topScene7(element){
	var hashVal = $(element).data("id")-1;
   	document.location.hash = hashVal+1;
    $(window).scrollTop($('.scene7-video-wrapper').offset().top-80);
}
$(".scene7-video-container video").click(function(){
$(this).parent().toggleClass("playing");
}); 
    </script> 